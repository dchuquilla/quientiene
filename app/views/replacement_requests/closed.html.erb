<div class="row justify-content-center">
  <div class="col-md-1 col-sm-1"></div>
  <div class="col">
    <div class="row">
      <div class="col-md-auto">
        <h1>
          <%= link_to dashboard_path, class:"btn btn-outline-dark btn-lg" do %>
            <i class="material-icons text-dark" style="top: 0;">arrow_back_ios_new</i>
          <% end %>
          Mis solicitudes cerradas
        </h1>
      </div>
      <div class="col">
        <%= search_form_for @rr_query, class: "form-inline ml-auto justify-content-end" do |f| %>
          <div class="form-group">
            <%= f.search_field :short_name_or_description_or_part_number_or_vehicle_brand_or_vehicle_model_cont, class: "form-control text-dark", placeholder: "Buscar" %>
          </div>
          <% if params[:q].present? %>
            <%= link_to replacement_requests_path, class: "btn btn-white btn-raised btn-fab btn-fab-mini btn-round" do %>
              <i class="material-icons">close</i>
            <% end %>
          <% else %>
            <button type="submit" class="btn btn-white btn-raised btn-fab btn-fab-mini btn-round">
              <i class="material-icons">search</i>
            </button>
          <% end %>
        <% end %>
      </div>
    </div>

    <% @replacement_requests.each_with_index do |replacement_request, index| %>
      <div class="card">
        <div class="card-header card-header-success card-header-icon">
          <div class="card-icon">
            <i class="material-icons">email</i>
          </div>
          <div class="row">
            <div class="col-md-4 col-sm-6">
              <p class="card-category text-dark"><%= replacement_request.updated_at.strftime('%d/%m/%Y %H:%M') %> </p>
            </div>
            <div class="col-md-8 col-sm-6">
              <p class="card-category text-dark"><%= replacement_request.vehicle.brand %> <%= replacement_request.vehicle.model %> <%= replacement_request.vehicle.year %> </p>
            </div>
          </div>
          <h3 class="card-title"><%= replacement_request.short_name %></h3>
        </div>
        <div class="card-body">
          <% if replacement_request.part_number.present? %>
            <h4>P/N: <%= replacement_request.part_number %></h4>
          <% end %>
          <%= replacement_request.description.html_safe %>
        </div>
        <div class="card-footer">
          <div class="stats align-items-center">
            <% if can?(:manage, replacement_request) && replacement_request.state != 'closed' %>
              <%= link_to edit_replacement_request_path(replacement_request), class:"text-info btn btn-outline-info btn-sm" do %>
                <i class="material-icons text-dark mr-2" style="top: 0;">mode_edit</i>
                Editar
              <% end %>
              <%= link_to replacement_request, method: :delete, data: { confirm: '¿Está seguro?' }, class:"text-danger btn btn-outline-danger btn-sm" do %>
                <i class="material-icons mr-2" style="top: 0;">remove_circle_outline</i>
                Eliminar
              <% end %>
            <% end %>
            <% if can?(:read, ReplacementProposal) && replacement_request.replacement_proposals.count > 0 %>
              <%= link_to replacement_proposals_path(replacement_request_id: replacement_request), class:"text-warning btn btn-outline-warning btn-sm" do %>
                <i class="material-icons mr-2" style="top: 0;">mark_email_read</i>
                Ver propuestas
              <% end %>
            <% end %>
            <% if can? :create, ReplacementProposal %>
              <%= link_to new_replacement_proposal_path(replacement_request_id: replacement_request), data: { turbolinks: false }, class:"text-warning btn btn-outline-warning btn-sm" do %>
                <i class="material-icons mr-2" style="top: 0;">mark_email_read</i>
                Agregar propueta
              <% end %>
            <% end %>
            <% if current_user.has_role?(:shop) && replacement_request.replacement_proposals.count == 0 %>
              <%= link_to ignore_replacement_request_path(replacement_request), data: { confirm: '¿Está seguro?' }, class:"text-danger btn btn-outline-danger btn-sm" do %>
                <i class="material-icons mr-2" style="top: 0;">close</i>
                Ignorar
              <% end %>
            <% end %>
          </div>
        </div>
      </div>
      <% if (index+1)%2 == 0 %>
        <p class="text-dark">
          Publicidad Aqui
        </p>
      <% end %>
    <% end %>

    <br>

  </div>
  <div class="col-md-1 col-sm-1"></div>
</div>

<% if current_user.has_role? :customer %>
  <div class="row justify-content-center">
    <div class="col-md-1 col-sm-1"></div>
    <div class="col">
      <%= link_to new_replacement_request_path, data: { turbolinks: false }, class:"btn btn-outline-primary btn-lg btn-block" do %>
        <i class="material-icons text-dark mr-3" style="top: 0;">flare</i>
        Solicitar repuesto
      <% end %>
    </div>
    <div class="col-md-1 col-sm-1"></div>
  </div>
  <br>
<% end %>

<div class="row justify-content-center">
  <div class="col-md-1 col-sm-1"></div>
    <div class="col">
      Publicidad Aqúi
    </div>
  <div class="col-md-1 col-sm-1"></div>
</div>